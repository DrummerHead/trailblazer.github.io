<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Trailblazer: 01- Getting Started With Operation</title>
<meta name="description" content="01- Getting Started With Operation - Trailblazer">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content=", ">

<!-- style -->
<link rel="shortcut icon" href="/favicon.ico">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,%20400,700,800%7CRaleway:400,200,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/css/application.css">

<!-- script -->
<script src="/javascripts/jquery.min.js"></script>
<script src="/javascripts/application.min.js"></script>
<script>
  jQuery(document).ready(function($) {
    $(document).foundation();

    anchors.add("article h2");
    anchors.add("article h3");

    hljs.configure({
      languages: ['ruby', 'haml']
    });

    hljs.initHighlightingOnLoad();

    // $('#code-slider').slick({arrows: true, dots: true});
    $('.carousel').slick({arrows: true, dots: true});
  });
</script>


<meta property="og:title" content="01- Getting Started With Operation">
<meta property="og:site_name" content="Trailblazer">
<meta property="og:url" content="http://trailblazer.to/guides/trailblazer/2.0/01-getting-started-with-operation.html">
<meta property="og:description" content="">
<meta property="og:image" content="http://trailblazer.to/images/go-trailblazer.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@apotonick">
<meta name="twitter:title" content="01- Getting Started With Operation">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="http://trailblazer.to/images/go-trailblazer.jpg">

  </head>
  <body>

    <div data-sticky-container class="top-navbar">
  <div class="top-bar sticky" data-sticky data-options="marginTop:0;" style="width:100%">
    <div class="top-bar-title">
      <ul class="menu horizontal">
        <li>
          <a href="/"><img style="height: 25px;" src="/images/logo-top.svg"></a>
        </li>
        <li>
        <span data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle></button>
        </span>
        </li>
      </ul>
    </div>

    <div id="responsive-menu">
      <div class="top-bar-right">
        <ul class="dropdown menu     vertical medium-horizontal" data-dropdown-menu>
          <li><a href="/gems/operation/2.0/release_notes.html">TRB 2.O IS COMING!</a></li>
          <li><a href="https://trbpro.herokuapp.com/">PREMIUM SUPPORT <img alt="Premium Support" src="/images/pro-white.png"></a></li>
          <li><a href="/newsletter/">NEWSLETTER</a></li>
          <li><a href="https://gitter.im/trailblazer/chat" onclick="trackOutboundLink('https://gitter.im/trailblazer/chat'); return false;">CHAT</a></li>
          <li><a href="/guides">GUIDES</a></li>
          <li>
            <a href="#">GEMS</a>
            <ul class="menu vertical">
              <li class=""><a href="/gems/cells">CELLS</a></li>
              <li class=""><a href="/gems/operation/2.0/index.html">OPERATION</a></li>
              <li class=""><a href="/gems/reform">REFORM</a></li>
              <li class=""><a href="/gems/representable">REPRESENTABLE</a></li>
              <li class=""><a href="/gems/roar">ROAR</a></li>
              <li class=""><a href="/gems/disposable">DISPOSABLE</a></li>
            </ul>
          </li>
          <li>
            <a href="https://leanpub.com/trailblazer" class="button secondary" onclick="trackOutboundLink('https://leanpub.com/trailblazer'); return false;">GET THE BOOK</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <!-- Hero -->
<div class="hero gems-hero operation2-hero">
  <div class="hero-unit">
    <div class="expanded row">
      <div class="columns">
        <h1 id="project_title">
          Operation
        </h1>
      </div>
    </div>
  </div>
</div>


    <div class="expanded row">
      <div class="medium-9 large-10 medium-push-3 large-push-2 columns">
        <article class="operation2-body">

          
            <header id="doc-header">
  <h1 class="doc-page-title">01- Getting Started With Operation</h1>
  <span class="doc-last-updated"><i class="fa fa-clock-o" aria-hidden="true"></i> Last updated 19 January 2017</span>

  
    <span class="doc-last-updated">
      <i class="fa fa-diamond" aria-hidden="true"></i>
      <a href="https://github.com/trailblazer/trailblazer-operation">operation</a>

      <a href="/guides/trailblazer/2.0/01-getting-started-with-operation.html">
      <span class="version">v2.0</span>
      </a>

    

    </span>
  

  <hr>

</header>

          

          <div class="row"> <!-- nach doc header -->
            <div class="large-9 columns" id="docs">   <!-- actual docs -->
              <p>The <em>Operation</em> is the central concept of the Trailblazer architecture. It is a simple service object that embraces and orchestrates all the business logic necessary to accomplish a certain task, such as creating a blog post, or updating a user.</p>

<p>In order to do so, the operation provides you an API to structure your business code into <em>steps</em>. Its API is heavily inspired by the “Railsway-oriented programming” pattern that combines structuring linear code, and error handling - but more on that later.</p>

<p>Don’t let yourself trick into the thinking the operation is a “god object”, as it’s been called by critics. The opposite is the case: the operation knows what to orchestrates and when, however, it has zero knowledge about the <em>how</em> since the implementation of the steps are hidden from it.</p>

<div class="callout">
  
<p>You can find the code for this page <a href="https://github.com/trailblazer/guides/tree/operation-01">here</a>.</p>

</div>

<h2 id="gemfile" data-magellan-target="gemfile">Gemfile</h2>

<p>In the <a href="https://github.com/trailblazer/guides/tree/operation-01">repository</a> for this page, you will find a very slim <code class="highlighter-rouge">Gemfile</code>.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>gem "trailblazer-operation"
gem "rspec"
</code></pre>
</div>

<p>The <code class="highlighter-rouge">trailblazer-operation</code> gem gives you the <code class="highlighter-rouge">Trailblazer::Operation</code> class and its Railway semantics. Nothing more. It does <em>not</em> have any other dependencies, which is why it is a great idea to start learning Trailblazer with a setup as simple as possible.</p>

<p>We will explore the operation’s behavior using specs. This is my personal favorite way to play with new ideas or gems. If you prefer Minitest, you may do so, Trailblazer is not coupled to any specific test framework.</p>

<h2 id="our-first-operation" data-magellan-target="our-first-operation">Our first Operation</h2>

<p>When implementing a blog website, it’s probably quite handy to empower a user to write and create a blog post.</p>

<p>In most web frameworks like Rails, you’d start with a <code class="highlighter-rouge">PostsController</code> and an action <code class="highlighter-rouge">#create</code> that receives and processes a post form.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>class PostsController &lt; RubyOnTrails::Controller
  def create
    post = Post.new
    post.update_attributes(params[:post])
    if post.save
      notify_current_user!
    else
      render
    end
  end
end
</code></pre>
</div>

<p>In Trailblazer, this is identical, only that the entire <em>business code</em> to create a post is embraced by an operation. Leaving routing and rendering responses up to the controller, the operation solely focuses on domain logic. The nice thing here is that we can start coding without any web framework or routing, and even without thinking about HTTP - a deeply relaxing thought.</p>

<p>An operation is simply a Ruby object that can be run anywhere.</p>

<p>In <code class="highlighter-rouge">app/post/operation/create.rb</code> I add an empty class.</p>

<pre><code>require "trailblazer/operation"

module Post
  class Create &lt; Trailblazer::Operation
  end
end
</code></pre>

<p><code class="highlighter-rouge">Create</code> is derived from <code class="highlighter-rouge">Trailblazer::Operation</code>. Do note that we’re inheriting <a href="https://github.com/trailblazer/trailblazer-operation/blob/master/lib/trailblazer/operation.rb">a few dozens lines</a> of code here, only.</p>

<h3 id="naming">Naming</h3>

<p>The actual <code class="highlighter-rouge">Create</code> operation is put into the <code class="highlighter-rouge">Post</code> namespace. This is very common in Trailblazer: we leverage Ruby namespaces. This results in the beautiful operation class named <code class="highlighter-rouge">Post::Create</code>, a very expressive class name, don’t you think?</p>

<p>Before adding any logic, let’s run this very operation via a spec in <code class="highlighter-rouge">spec/post/operation/create_spec.rb</code>.</p>

<pre><code>require "spec_helper"
require_relative "../../../app/post/operation/create"

RSpec.describe "Create" do
  it do
    Post::Create.()
  end
end
</code></pre>

<p>In an empty test case, we invoke (or <em>call</em>) our yet unspoiled operation.</p>

<h3 id="call">Call</h3>

<p>That’s right, there’s only one way to run an operation, and that’s the “<code class="highlighter-rouge">call</code> style”. Confused? Here’s how to spell that alternatively.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>Post::Create.call()
</code></pre>
</div>

<p>This behavior is pure Ruby and was introduced in Ruby 1.9, if I remember correctly. While this might look bizarre to you at first glance, there’s a profound reasoning behind this decision.</p>

<p>An operation conceptually is a <em>function</em>, it does only one thing and doesn’t need more than one public method. Since the operation’s name reflect what it does, you don’t need a method name. This is why in Trailblazer you will have many <code class="highlighter-rouge">call</code>able objects instead of one object with many methods.</p>

<div class="callout">
  
<p>You will soon learn how this greatly improves your architecture since the functional approach minimizes internal state and the <a href="https://apotonick.wordpress.com/2014/05/22/rails-misapprehensions-single-responsibility-principle/">associated mess it might create</a>.</p>

</div>

<p>While our spec works, or at least no exception is raised, this is not very impressive. Let’s see what it actually returns.</p>

<pre><code>it do
  result = Post::Create.()
  puts result #=&gt; #&lt;Trailblazer::Operation::Result:0x9cd7dc4&gt;
end
</code></pre>

<p>Calling an operation always gives you a <em>result object</em>. It is used to transport state, communicate internals to the outer world, and to indicate whether or not this operation was successful. We will talk about it in a few minutes.</p>

<h3 id="steps">Steps</h3>

<p>It might be a good idea to actually add some logic to our operation. While we could simply add a big method with lots of code in a nested procedural style, Trailblazer encourages you to structure your code into a <em>pipeline</em>, where steps in the pipe implement parts of the domain code.</p>

<pre><code>module Post
  class Create &lt; Trailblazer::Operation
    step :hello_world!

    def hello_world!(options, *)
      puts "Hello, Trailblazer!"
    end
  end
end
</code></pre>

<p>Adding steps usually works with the <a href="http://trailblazer.to/gems/operation/2.0/api.html#flow-control-step"><code class="highlighter-rouge">step</code> method</a>. It allows to implement steps using methods, <a href="">lambdas</a> and <a href="">callable objects</a>. For simplicity, let’s go with instance methods for now.</p>

<p>We also call the pipe a <em>railway</em> because it has different tracks.</p>


            </div>

            <div class="large-3 columns sticky-container" data-sticky-container>

              
                <nav class="sticky columns docs-toc-wrap sticky is-anchored is-at-top side-nav" data-sticky data-anchor="docs" data-sticky-on="large" data-margin-top="5">
  
        <ul class="vertical menu" data-magellan id="page-toc">
          <li class="page-toc-heading">ON THIS PAGE:</li>
          <li><a href="#gemfile">Gemfile</a></li>
<li><a href="#our-first-operation">Our first Operation</a></li>
        </ul>
      
</nav>

              

            </div>
          </div>
        </article>
      </div>

      <div class="medium-3 large-2 medium-pull-9 large-pull-10 columns">
        <ul class="vertical menu side-nav">
    <li class="heading">
        <a href="/gems/operation/2.0/index.html">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> OPERATION
        </a>
    </li>
    <li><a href="/gems/operation/2.0/api.html">API</a></li>
    <li><a href="/gems/operation/2.0/contract.html">Contract</a></li>
    <!-- <li><a href="/gems/operation/2.0/representer.html">Representer</a></li> -->
    <li><a href="/gems/operation/2.0/policy.html">Policy</a></li>
    <li><a href="/gems/operation/2.0/representer.html">Representer</a></li>
<!--     <li><a href="/gems/operation/2.0/pipetree.html">Pipetree</a></li>
 -->
    <li><a href="/gems/operation/2.0/endpoint.html">Endpoint</a></li>
    <li>
<a href="/gems/operation/1.1/index.html">
          <span class="sidebar-info">→ v1.1</span>
        </a>
    </li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/trailblazer/index.html">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> TRAILBLAZER
        </a>
    </li>
    <li><a href="/gems/trailblazer/2.0/rails.html">Rails</a></li>
    <li><a href="/gems/trailblazer/loader.html">Loader</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/cells">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> CELLS
        </a>
    </li>
    <li><a href="/gems/cells/getting-started.html">Getting Started<span class="sidebar-info">NEW</span></a></li>
    <li><a href="/gems/cells/api.html">API</a></li>
    <li><a href="/gems/cells/trailblazer.html">Trailblazer::Cell</a></li>
    <li><a href="/gems/cells/testing.html">Testing</a></li>
    <li><a href="/gems/cells/render.html">Rendering</a></li>
    <li><a href="/gems/cells/rails.html">Rails</a></li>
    <li><a href="/gems/cells/templates.html">Templates</a></li>
    <li><a href="/gems/cells/troubleshooting.html">Troubleshooting</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/reform">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> REFORM
        </a>
    </li>
    <li><a href="/gems/reform/api.html">API</a></li>
    <li><a href="/gems/reform/options.html">Options</a></li>
    <li><a href="/gems/reform/data-types.html">Data Types</a></li>
    <li><a href="/gems/reform/populator.html">Populator</a></li>
    <li><a href="/gems/reform/prepopulator.html">Prepopulator</a></li>
    <li><a href="/gems/reform/validation.html">Validation</a></li>
    <li><a href="/gems/reform/rails.html">Rails</a></li>
    <li><a href="/gems/reform/debugging.html">Debugging</a></li>
    <li><a href="/gems/reform/upgrading-guide.html">Upgrading Guide</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/representable">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> REPRESENTABLE
        </a>
    </li>
    <li><a href="/gems/representable/getting-started.html">Getting Started</a></li>
    <li><a href="/gems/representable/3.0/api.html">API</a></li>
    <li><a href="/gems/representable/3.0/function-api.html">Function API</a></li>
    <li><a href="/gems/representable/3.0/populator.html">Populator</a></li>
    <!-- <li><a href="/gems/representable/architecture.html">Architecture</a></li> -->
    <li><a href="/gems/representable/3.0/xml.html">XML</a></li>
    <li><a href="/gems/representable/3.0/yaml.html">YAML</a></li>
    <li><a href="/gems/representable/upgrading-guide.html">Upgrading Guide</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/roar">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> ROAR
        </a>
    </li>
    <li><a href="/gems/roar/jsonapi.html">JSON API</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/gems/disposable">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> DISPOSABLE
        </a>
    </li>
    <li><a href="/gems/disposable/api.html">API</a></li>
    <li><a href="/gems/disposable/default.html">Default</a></li>
    <li><a href="/gems/disposable/callback.html">Callback</a></li>
    <li class="divider">

    <li class="heading">
        <a href="/guides">
            <i class="fa fa-caret-square-o-right" aria-hidden="true"></i> GUIDES
        </a>
    </li>
    <li><a href="/guides/trailblazer-in-20-minutes.html">Trailblazer In 20 Minutes</a></li>
    <li><a href="/guides/getting-started.html">Getting Started</a></li>
    <li><a href="/guides/sinatra/getting-started.html">Sinatra</a></li>
    <li><a href="/guides/grape.html">Grape</a></li>
</ul>

      </div>
    </div>


    <section class="top-footer">
  <div class="row">
    <div class="columns medium-6">
      <h3>Newsletter</h3>
      <p>
        Stay on top of what’s happening in Trailblazer.
      </p>
        <div class="row">
          <div id="mc_embed_signup">
            <form action="//trailblazerb.us8.list-manage.com/subscribe/post?u=bbe5021ab6fbdc94a16f0d036&amp;id=a69f6e4652" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>

              <div class="columns large-9 medium-12 ">
                <div class="row collapse prefix-radius">
                  <div class="small-8 medium-7 large-8 columns">
                    <div id="mc_embed_signup_scroll">
                      <div class="mc-field-group">
                        <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="youremail@trailblazer.to">
                      </div>
                      <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                      </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_bbe5021ab6fbdc94a16f0d036_a69f6e4652" tabindex="-1" value=""></div>

                    </div>
                  </div>
                  <div class="small-4 medium-5 large-4 columns">
                    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button postfix secondary">
                  </div>
                </div>
              </div>
            </form>
          </div>
          <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
        </div>
      <p>
        And check out the <a href="/newsletter/">archive of newsletters</a>!
      </p>


    </div>
    <div class="columns medium-6">
      <h3>The Book</h3>
      <p>Learn how to build a Rails app with Trailblazer, step-by-step.</p>
      <a href="https://leanpub.com/trailblazer" class="button secondary">Get the book!</a>
    </div>
  </div>
</section>

<footer>
  <div class="row">
    <div class="columns medium-4">
      <div class="logo-box">
        <a href="/"><img src="/images/icon_trb.png">
        </a>
      </div>
    </div>
    <div class="columns medium-8">
      <div class="row">
        <div class="columns medium-6">
          <h4>
            Trailblazer
          </h4>
          <ul class="no-bullet">
            <li><a href="https://gitter.im/trailblazer/chat">Gitter chat</a></li>
            <li><a href="https://leanpub.com/trailblazer" onclick="trackOutboundLink('https://leanpub.com/trailblazer'); return false;">The book</a></li>
          </ul>
        </div>
        <div class="columns medium-6">
          <h4>
            Follow Us
          </h4>
          <ul class="menu">
            <li>
              <a href="https://github.com/trailblazer">
                <i class="footer-icon github-icon"></i>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/apotonick">
                <i class="footer-icon twitter-icon"></i>
              </a>
            </li>
            <li>
              <a href="https://facebook.com/trbinc">
                <i class="footer-icon facebook-icon"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <p class="copyright">
        Trailblazer is created by <a href="http://www.synergysoft.com.sg/">Synergy Software Solutions Pte Ltd,</a> and awesome friends.
      </p>
      <p class="copyright">
        Site designed and handcoded with love by <a href="https://twitter.com/noeliacabane">Noelia Cabane</a>
      </p>
    </div>
  </div>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69514939-1', 'auto');
  ga('send', 'pageview');

  /**
  * Function that tracks a click on an outbound link in Analytics.
  * This function takes a valid URL string as an argument, and uses that URL string
  * as the event label. Setting the transport method to 'beacon' lets the hit be sent
  * using 'navigator.sendBeacon' in browser that support it.
  */
  var trackOutboundLink = function(url) {
     ga('send', 'event', 'outbound', 'click', url, {
       'transport': 'beacon',
       'hitCallback': function(){document.location = url;}
     });
  }
</script>



  </body>
</html>
