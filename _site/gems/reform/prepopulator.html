<!doctype html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> - </title>
    <meta name="description" content=" - " />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="keywords" content=", " />

    <!-- CSS  Get: http://www.google.com/fonts/
    http://stackoverflow.com/questions/7985081/how-to-deploy-a-jekyll-site-locally-with-css-js-and-background-images-included
    ================================================== -->
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,700,800|Raleway:400,200,700" rel="stylesheet" type="text/css">
    <!-- Fount Awesome -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="stylesheet" href="css/style.css" />
    <link rel="shortcut icon" href="favicon.ico">
    <meta property="og:title" content=""/>
    <meta property="og:site_name" content=" - "/>
    <meta property="og:url" content=" - "/>
    <meta property="og:description" content=""/>
    <meta property="og:image" content=""/>
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="">
    <script src="bower_components/modernizr/modernizr.js"></script>
  </head>

  <body>
    <!-- Top Bar -->
    <nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1><a href="#">Trailblazer</a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="right">
      <li class="active"><a href="#">Right Button Active</a></li>
    </ul>
  </section>
</nav>


    <!-- Hero -->
    <div class="hero">
  <div class="hero-unit">
    <div class="row">
      <div class="columns">
        <h1 id="project_title">
          <!-- <a href="#"><img src="/images/icon_trb.png">
          </a> -->
          Trailblazer
        </h1>
        <h2>A new architecture for Rails</h2>
      </div>
    </div>
  </div>
</div>



    <div class="row">
      <div class="columns large-3">
        <!--    <a href="https://github.com/trailblazer/www.trailblazerb.org" class="button">View on GitHub</a>
        <a class="button" href="https://github.com/trailblazer/www.trailblazerb.org/zipball/master">Download this project as a .zip file</a>
        <a class="button" href="https://github.com/trailblazer/www.trailblazerb.org/tarball/master">Download this project as a tar.gz file</a> -->

<ul class="side-nav">
  <li><a href="#">Link 1</a></li>
  <li><a href="#">Link 2</a></li>
  <li><a href="#">Link 3</a></li>
  <li><a href="#">Link 4</a></li>
</ul>

      </div>
      <div class="columns medium-9">
        <h1 id="prepopulating">Prepopulating</h1>

<p>Reform has two completely separated modes for form setup. One when rendering the form and one when populating the form in <code>validate</code>.</p>

<p><a href="/gems/reform/prepopulator.html">Prepopulating</a> is helpful when you want to fill out fields (aka. <em>defaults</em>) or add nested forms before rendering.</p>

<p><a href="/gems/reform/populators.html">Populating</a> is invoked in <code>validate</code> and will add nested forms depending on the incoming hash.</p>

<p>This page explains prepopulation used to prepare the form for rendering.</p>

<h2 id="configuration">Configuration</h2>

<p>You can use the <code>:prepopulator</code> option on every property or collection.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">AlbumForm</span> <span class="o">&lt;</span> <span class="no">Reform</span><span class="o">::</span><span class="no">Form</span>
  <span class="n">property</span> <span class="ss">:artist</span><span class="p">,</span> <span class="ss">prepopulator</span><span class="p">:</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="n">artist</span> <span class="o">=</span> <span class="no">Artist</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span> <span class="k">do</span>
    <span class="n">property</span> <span class="ss">:name</span>
  <span class="k">end</span></code></pre></div>

<p>The option value can be a lambda or an instance method name.</p>

<p>In the block/method, you have access to the form API and can invoke any kind of logic to prepopulate your form. Note you need to assign models for nested form using their writers.</p>

<h2 id="invocation">Invocation</h2>

<p>Prepopulation must be invoked manually.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">form</span> <span class="o">=</span> <span class="no">AlbumForm</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">Album</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
<span class="n">form</span><span class="o">.</span><span class="n">artist</span> <span class="c1">#=&gt; nil</span>

<span class="n">form</span><span class="o">.</span><span class="n">prepopulate!</span>

<span class="n">form</span><span class="o">.</span><span class="n">artist</span> <span class="c1">#=&gt; &lt;nested ArtistForm @model=&lt;Artist ..&gt;&gt;</span></code></pre></div>

<p>This explicit call must happen before the form gets rendered. For instance, in Trailblazer, this happens in the controller action.</p>

<h2 id="prepopulate-is-not-populate">Prepopulate is not Populate</h2>

<p><code>:populator</code> and <code>:populate_if_empty</code> will be run automatically in <code>validate</code>. Do not call <code>prepopulate!</code> before <code>validate</code> if you use the populator options. This will usually result in “more” nested forms being added as you wanted (unless you know what you’re doing).</p>

<p>Prepopulators are a concept designed to <strong>prepare a form for rendering</strong>, whereas populators are meant to <strong>set up the form in <code>validate</code></strong> when the input hash is deserialized.</p>

<p>This is explained in the <em>Nested Forms</em> chapter of the Trailblazer book. Please read it first if you have trouble understanding this, and then open an issue.</p>

<h2 id="options">Options</h2>

<p>Options may be passed. They will be available in the <code>:prepopulator</code> block.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">AlbumForm</span> <span class="o">&lt;</span> <span class="no">Reform</span><span class="o">::</span><span class="no">Form</span>
  <span class="n">property</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">prepopulator</span><span class="p">:</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">options</span><span class="o">[</span><span class="ss">:def_title</span><span class="o">]</span> <span class="p">}</span>
<span class="k">end</span></code></pre></div>

<p>You can then pass arbitrary arguments to <code>prepopulate!</code>.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">form</span><span class="o">.</span><span class="n">title</span> <span class="c1">#=&gt; nil</span>

<span class="n">form</span><span class="o">.</span><span class="n">prepopulate!</span><span class="p">(</span><span class="ss">def_title</span><span class="p">:</span> <span class="s2">&quot;Roxanne&quot;</span><span class="p">)</span>

<span class="n">form</span><span class="o">.</span><span class="n">title</span> <span class="c1">#=&gt; &quot;Roxanne&quot;</span></code></pre></div>

<p>The arguments passed to the <code>prepopulate!</code> call will be passed straight to the block/method.</p>

<p>This call will be applied to the entire nested form graph recursively <em>after</em> the currently traversed form’s prepopulators were run.</p>

<h2 id="execution">Execution</h2>

<p>The blocks are run in form instance context, meaning you have access to all possible data you might need. With a symbol, the same-named method will be called on the form instance, too.</p>

<p>Note that you have to assign the pre-populated values to the form by using setters. In turn, the form will automatically create nested forms for you.</p>

<p>This is especially cool when populating collections.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">property</span> <span class="ss">:songs</span><span class="p">,</span>
  <span class="ss">prepopulator</span><span class="p">:</span> <span class="o">-&gt;</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="n">songs</span> <span class="o">&lt;&lt;</span> <span class="no">Song</span><span class="o">.</span><span class="n">new</span> <span class="k">if</span> <span class="n">songs</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="p">}</span> <span class="k">do</span></code></pre></div>

<p>This will always add an empty song form to the nested <code>songs</code> collection until three songs are attached. You can use the <code>Twin::Collection</code> <a href="/gems/disposable/collection.html">API</a> when adding, changing or deleting items from a collection.</p>

<p>Note that when calling <code>#prepopulate!</code>, your <code>:prepopulate</code> code for all existing forms in the graph will <em>be executed</em> . It is up to you to add checks if you need that.</p>

<h2 id="overriding">Overriding</h2>

<p>You don’t have to use the <code>:prepopulator</code> option. Instead, you can simply override <code>#prepopulate!</code> itself.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">AlbumForm</span> <span class="o">&lt;</span> <span class="no">Reform</span><span class="o">::</span><span class="no">Form</span>
  <span class="k">def</span> <span class="nf">prepopulate!</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="nb">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Roxanne&quot;</span>
    <span class="nb">self</span><span class="o">.</span><span class="n">artist</span> <span class="o">=</span> <span class="no">Artist</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;The Police&quot;</span><span class="p">)</span>
  <span class="k">end</span></code></pre></div>

<h1 id="defaults">Defaults</h1>

<p>There’s different alternatives for setting a default value for a formerly empty field.</p>

<ol>
  <li>Use <code>:prepopulator</code> as <a href="#configuration">described here</a>. Don’t forget to call <code>prepopulate!</code> before rendering the form.</li>
  <li>Override the reader of the property. This is not recommended as you might screw things up. Remember that the property reader is called for presentation (in the form builder) and for validation in <code>#validate</code>.</li>
</ol>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">property</span> <span class="ss">:title</span>

<span class="k">def</span> <span class="nf">title</span>
  <span class="k">super</span> <span class="ow">or</span> <span class="s2">&quot;Unnamed&quot;</span>
<span class="k">end</span></code></pre></div>


      </div>
    </div>

    <!-- The Book -->
    <div class="row">
      <div class="columns">
        <h2>The Book</h2>
<div class="row">
  <div class="columns medium-3">
    <a href="https://leanpub.com/trailblazer">
    <img src="images/3dbuch-freigestellt.png" />
    </a>
  </div>

  <div class="columns medium-9">
    <p>Yes, there's a book!</p>
    <p>Written by the busy creator of Trailblazer, it is about 70% finished and will get another 150 pages, making it 300 pages full of wisdom about Trailblazer and all the gems.</p>

    <p>If you want to learn about this project and if you feel like supporting Open-Source, please <a href="https://leanpub.com/trailblazer">buy and read it</a> and let us know what you think.</p>
  </div>
</div>

      </div>
    </div>


    <!-- Testimonials -->
    <div class="row">
      <div class="columns">
        <h2>
  Testimonials
</h2>

<blockquote>
  At some point of time we started to decouple our form objects from models. Things got a lot easier when we found out there is a ready to use solution which solves our exact problem. That was Reform. Soon after, we started using all other parts of Trailblazer and haven't regretted a second of our time we spent using it.
  <cite>Igor Pstyga, Shop Hers Inc</cite>
</blockquote>

<blockquote>
  Here at Chefsclub, we are very happy with Trailblazer. Our application already has 32 concepts, 130+ operations, and Cells surprised us as an awesome feature. We feel pretty safe with it.
  <cite>Paulo Fabiano Langer, Chefsclub</cite>
</blockquote>

<blockquote>
  Trailblazer helps organize my code, the book showed me how. You can assume what each component does by its name, it's very easy and intuitive, it should be shipped as an essential part of Rails.
  <cite>Yuri Freire Lima, AzClick</cite>
</blockquote>

      </div>
    </div>


    <!-- Footer -->
    <footer>
  <div class="row">
    <div class="columns">
      <p>Trailblazer maintained by <a href="https://github.com/trailblazer">trailblazer</a></p>
    </div>
  </div>
</footer>




    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="bower_components/jquery/jquery.js"><\/script>')</script>
    <script src="js/plugins.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>
    <script src="js/script.js"></script>

  </body>
</html>
